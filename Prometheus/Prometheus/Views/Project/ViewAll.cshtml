
@model IEnumerable<Prometheus.Models.ProjectViewModels>

@{
    ViewBag.Title = "Project View All";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var idx = 0;
    var pjtpdict = new Dictionary<string, bool>();
    var pjtypelist = new List<string>();
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.Parallel);
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.Tunable);
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.OSA);
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.LineCard);
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.QM);
    pjtypelist.Add(Prometheus.Models.ProjectTypeInf.Others);

    foreach (var item in Model)
    {
        var tpstr = "";
        if (string.IsNullOrEmpty(item.ProjectType))
        {
            tpstr = "Parallel";
            item.ProjectType = "Parallel";
        }
        else
        {
            tpstr = item.ProjectType;
        }

        if (!pjtpdict.ContainsKey(tpstr))
        {
            pjtpdict.Add(tpstr, true);
        }
    }
}


<div class="row">
    <div class="col-lg-2">
        <h2>All Projects</h2>
    </div>
    <div class="col-lg-2">

    </div>
    <div class="col-lg-8"></div>
</div>


<hr />

    <div class="row col-lg-12">
        <div class="col-lg-1">
            <label class="control-label" for="pjfilterlist">Filter:</label>
        </div>
        <div class="col-lg-4">
            @Html.DropDownList("pjfilterlist", null, new { @id = "pjfilterlist", @class = "form-control",@onchange = "ShowProjectDetail()" })
        </div>
        <div class="col-lg-7">
        </div>
    </div>

    <script type="text/javascript">
        function ShowProjectDetail() {
            if (document.getElementById("pjfilterlist").value && document.getElementById("pjfilterlist").value != 'NONE')
            {
                window.location.href = '/Project/ProjectDetail?ProjectKey=' + document.getElementById("pjfilterlist").value;
            }
        }
    </script>
<hr/>

<div class="panel-group" id="accordion">
    @foreach (var pjtype in pjtypelist)
    {
        if (pjtpdict.ContainsKey(pjtype))
        {
            <div class="panel panel-default" id="panel@(idx)">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-target="#collapse@(idx)" href="#collapse@(idx)" class="collapsed">@pjtype</a>
                    </h4>
                </div>

                <div id="collapse@(idx)" class="panel-collapse collapse">
                    <div class="panel-body">

                    @foreach (var item in Model)
                    {
                        if (string.Compare(item.ProjectType, pjtype, true) != 0)
                        { continue; }

                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <div class="col-lg-3">
                                                    <a href="/Project/ProjectDetail?ProjectKey=@item.ProjectKey">
                                                        <span class="glyphicon glyphicon-home" aria-hidden="true"></span> @item.ProjectName
                                                    </a>
                                                </div>
                                                <div class="col-lg-6"></div>
                                                <div class="col-lg-3 text-right">
                                                    <a href="/Project/EditProject?ProjectKey=@item.ProjectKey">
                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Modify
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        @if (string.Compare(item.ProjectType, Prometheus.Models.ProjectTypeInf.QM) != 0)
                                        {
                                            <div class="panel-body col-lg-12">
                                                <div class="row col-lg-12">
                                                    <div class="col-lg-2 text-left">
                                                        @if (item.FirstYield > 0)
                                                        {
                                                            <a href="/Project/ProjectYieldMain?ProjectKey=@item.ProjectKey">
                                                                <span class="glyphicon glyphicon-stats" aria-hidden="true"></span> FPY @((item.FirstYield * 100.0).ToString("0.0")) %
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="/Project/ProjectYieldMain?ProjectKey=@item.ProjectKey">
                                                                <span class="glyphicon glyphicon-stats" aria-hidden="true"></span>Project Yield
                                                            </a>
                                                        }
                                                    </div>
                                                    <div class="col-lg-2">
                                                        @if (item.RetestYield > 0)
                                                        {
                                                            <a href="/Project/ProjectYieldMain?ProjectKey=@item.ProjectKey">
                                                                <span class="glyphicon glyphicon-stats" aria-hidden="true"></span>FY @((item.RetestYield * 100.0).ToString("0.0")) %
                                                            </a>
                                                        }
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectFA?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span> Project FA
                                                            @if (item.FinishRating < 90)
                                                            {
                                                                <span class="badge alert-danger">@item.PendingFACount</span>
                                                            }
                                                            else
                                                            {
                                                                <span class="badge alert-success">@item.PendingFACount</span>
                                                            }
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectIssues?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Project Tasks <span class="badge alert-danger">@item.PendingTaskCount</span>
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/BurnIn/BurnInMainPage?ProjectKey=@item.ProjectKey" target="_blank">
                                                            <span class="glyphicon glyphicon-fire" aria-hidden="true"></span> Project Burn-In
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectRMAStatus?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-flash" aria-hidden="true"></span> RMA Status<span class="badge alert-danger">@item.PendingRMACount</span>
                                                        </a>
                                                    </div>
                                                </div>
                                                <hr />
                                                <div class="row col-lg-12">
                                                    <div class="col-lg-2 text-left">
                                                        <a href="/Project/ProjectError?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span> Debug Tree
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectNPI?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span> Project NPI Process
                                                        </a>
                                                    </div>

                                                    @if (!string.IsNullOrEmpty(item.CurrentNPIProc)
                                                         && !string.IsNullOrEmpty(item.PIP1Date)
                                                         && !string.IsNullOrEmpty(item.MVTDate))
                                                    {
                                                        <div class="col-lg-1 text-center active"><a href="/Issue/UpdateIssue?issuekey=@item.CurrentNPIProcKey">@item.CurrentNPIProc</a></div>
                                                        <div class="col-lg-2 text-center active">@item.PIP1Date</div>
                                                        <div class="col-lg-2 text-center active">@item.MVTDate</div>
                                                        <div class="col-lg-3 text-center"></div>
                                                    }
                                                    else
                                                    {
                                                        <div class="col-lg-8 text-center"></div>
                                                    }

                                                </div>

                                            </div>
                                        }
                                        else
                                        {
                                            <div class="panel-body col-lg-12">
                                                <div class="row col-lg-12">
                                                    
                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectIssues?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Project Tasks <span class="badge alert-danger">@item.PendingTaskCount</span>
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center">
                                                        <a href="/Project/ProjectRMAStatus?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-flash" aria-hidden="true"></span> RMA Status<span class="badge alert-danger">@item.PendingRMACount</span>
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-left">
                                                        <a href="/Project/ProjectOBA?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-record" aria-hidden="true"></span> Project OBA
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-left">
                                                        <a href="/Project/ProjectQuality?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Quality Issue
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-left">
                                                        <a href="/Project/ProjectReliability?ProjectKey=@item.ProjectKey">
                                                            <span class="glyphicon glyphicon-registration-mark" aria-hidden="true"></span> Reliability Issue
                                                        </a>
                                                    </div>

                                                    <div class="col-lg-2 text-center"></div>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                            <hr/>
                        }

                    </div>
                </div>
            </div>
            idx = idx + 1;
        }
    }
</div>


